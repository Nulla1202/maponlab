# 📘 PaperMap プロトタイプ設計書（MVP版）

## 🧭 1. プロジェクト概要

### アプリ名
**PaperMap** — 論文から「知の地図」を描く。

### コンセプト
研究論文をアップロードすると、著者の所属機関を自動で解析し、世界地図上にピンを表示。「この研究はどこの国・大学から発信されたのか」を直感的に把握できる。

### 目的
- 論文情報を地理的に整理・可視化する
- 所属や国ごとの研究傾向を可視化する
- 論文を整理しつつ、研究ネットワークを地図で俯瞰できるようにする

### 想定ユーザー
- 研究者・大学院生・論文レビュー担当者
- 技術調査担当（R&D、特許調査）
- 学術愛好家、研究マップを作りたい人

---

## 🧩 2. コア機能一覧（MVP範囲）

| No | 機能名 | 内容 | 備考 |
|---|---|---|---|
| 1 | 論文アップロード | PDFをブラウザから選択してアップロード | Google Drive連携（ユーザー認証済み） |
| 2 | 著者情報抽出 | PDF本文から著者名・所属機関を解析 | ローカルJS/Pythonで解析（PyMuPDF） |
| 3 | 所属地名→座標変換 | 機関名をNominatim APIで緯度経度取得 | キャッシュ機構あり |
| 4 | 地図描画 | Leaflet + OpenStreetMapで表示 | Google Maps非使用 |
| 5 | ピン情報表示 | ピンをクリックで著者・論文情報表示 | モーダル表示 |
| 6 | データ保存 | ユーザーのDriveまたはIndexedDBに保存 | JSON形式 |
| 7 | 検索・フィルタ | 著者名・国名での簡易検索 | MVP後期対応予定 |

---

## 🧠 3. システム構成概要

```
┌────────────────────────┐
│   PaperMap (Web App)   │
│  - React / Next.js     │
│  - Leaflet             │
│  - Google OAuth        │
│  - IndexedDB/Drive保存 │
└──────────┬─────────────┘
           │
           ▼
┌──────────────────┐
│  PDF解析モジュール │
│  (PyMuPDF / WASM) │
└──────────┬───────┘
           │
           ▼
┌──────────────────┐
│  Nominatim API   │
│ (OpenStreetMap)  │
└──────────┬───────┘
           │
           ▼
┌──────────────────┐
│ Leaflet地図描画  │
└──────────────────┘
```

---

## ⚙️ 4. 技術仕様

| 要素 | 技術 | 補足 |
|---|---|---|
| フロントエンド | React + Vite / Next.js | 静的ホスティング対応 |
| PDF解析 | PyMuPDF (WASM) / pdfminer.six | クライアント側で実行 |
| 認証 | Google OAuth 2.0 | Driveアクセス許可 |
| ストレージ | Google Drive API / IndexedDB | 論文実体とメタ情報 |
| 地図描画 | Leaflet.js + OpenStreetMapタイル | 完全無料 |
| ジオコーディング | Nominatim API (OSM) | 無料、キャッシュ推奨 |
| DB（メタ情報） | IndexedDB（ブラウザ内） | 軽量・オフライン対応 |
| デプロイ先 | Vercel / Cloudflare Pages | 無料枠で十分稼働 |

---

## 💾 5. データ設計

### 5.1 論文メタ情報（paper）

| フィールド名 | 型 | 説明 |
|---|---|---|
| id | string | UUID |
| title | string | 論文タイトル |
| authors | array | 著者名リスト |
| affiliations | array | 所属機関リスト |
| geo_points | array | 各所属の座標 [lat, lon] |
| pdf_url | string | Drive上のURL |
| uploaded_at | datetime | アップロード日時 |

### 5.2 キャッシュデータ（geo_cache）

| フィールド名 | 型 | 説明 |
|---|---|---|
| affiliation_name | string | 大学・機関名 |
| lat | float | 緯度 |
| lon | float | 経度 |

---

## 🗺️ 6. 画面設計（ワイヤーフレーム概要）

### ① ホーム画面
- ボタン：「PDFをアップロード」
- Drive連携ボタン：「Google Driveを接続」
- 最近アップロードされた論文リスト（タイトル＋日時）

### ② 地図画面
- 世界地図（Leaflet）
- ピン表示（所属機関単位）
- ピンをクリック → モーダルで著者一覧＋論文タイトル表示

### ③ 論文詳細画面（オプション）
- PDFタイトル、著者一覧、所属リスト
- 「地図で表示」ボタン

---

## 💡 7. コスト・パフォーマンス戦略

| 項目 | 対策 | 費用 |
|---|---|---|
| ストレージ | Google Driveを利用 | 無料 |
| 解析 | クライアント側で処理 | 無料 |
| 地図API | Leaflet + OSM | 無料 |
| ジオコーディング | Nominatim (制限付き) | 無料 |
| ホスティング | Cloudflare Pages / Vercel | 無料枠内 |
| DB | IndexedDB | 無料 |
| **合計** | | **¥0〜¥200/月** |

---

## 🚀 8. 将来拡張（Phase 2以降）

| 機能 | 内容 |
|---|---|
| 自動要約 | AI要約モデルを追加（OpenAI APIなど） |
| 分野別フィルタ | AI分類による研究分野タグ付け |
| 統計ダッシュボード | 国別・大学別分布グラフ |
| コラボレーション | 他ユーザーとのマップ共有機能 |
| 被引用ネットワーク | 引用関係を線で可視化 |

---

## 🧭 9. MVP開発スケジュール（想定）

| フェーズ | 内容 | 期間目安 |
|---|---|---|
| Phase 1 | UIモックアップ作成、地図描画テスト | 1〜2週間 |
| Phase 2 | PDF解析ロジック＋Drive連携 | 2〜3週間 |
| Phase 3 | Nominatim連携＋ピン可視化 | 1〜2週間 |
| Phase 4 | キャッシュ機能・UI調整 | 1週間 |
| **合計** | **約6〜8週間でMVP完成** | |

---

## 📝 備考

- 本設計書はMVP（Minimum Viable Product）版を対象としています
- 機能追加や仕様変更は、アーキテクチャドキュメント（architecture.md）と合わせて随時更新してください
